var m=require("sass"),n=require("path"),f=require("postcss"),l=require("cssnano"),p=require("node:fs/promises"),w=require("autoprefixer"),{writeFile:d,mkdir:y}=p,o=process.cwd(),i=e=>typeof e=="string"&&e.length>0;module.exports=(e={})=>{let s=i(e.from)?e.from:null,t=e.outDir||"out";return{name:"cssPlugin",setup:c=>{c.onStart(async()=>{await y(t,{recursive:!0})}),c.onEnd(async g=>{try{if(!s)throw new Error("Must specify 'from' option");let r=i(e.fileName)?e.fileName:n.basename(s,n.extname(s)),{css:a}=await m.compileAsync(`${o}/${s}`,{style:"compressed"}),u=await f([l({plugins:[w]})]).process(a,{from:void 0});await d(`${o}/${t}/${r}.css`,`${u.css}`)}catch(r){console.error(r.message)}})}}};